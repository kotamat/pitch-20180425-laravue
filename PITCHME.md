# AWSã§æ§‹ç¯‰ã™ã‚‹Nuxt.jsã®ã‚¤ãƒ³ãƒ•ãƒ©æ§‹ç¯‰3é¸

---

## è‡ªå·±ç´¹ä»‹

- æ ªå¼ä¼šç¤¾SCOUTER CTO
- @kotamat
- ğŸš²

+++

![èŒ‚æœ¨](src/assets/img/motegi.png)

+++

## æŠ€è¡“ç™ºä¿¡

- Laravueå‹‰å¼·ä¼š
- æŠ€è¡“ãƒ–ãƒ­ã‚°
- NuxtMeetup

+++

### æŠ€è¡“ãƒ–ãƒ­ã‚°

![æŠ€è¡“ãƒ–ãƒ­ã‚°](src/assets/img/techblog.png)

+++

- SCOUTERã®æŠ€è¡“ç™ºä¿¡
- æœ€è¿‘ãƒ•ãƒ­ãƒ³ãƒˆå¤šã‚
- Laravelã‚„ã‚¤ãƒ™ãƒ³ãƒˆãƒ¬ãƒãƒ¼ãƒˆãªã©ãªã©

+++

### NuxtMeetup

![NuxtMeetup](src/assets/img/nuxt-meetup.png)

- Nuxt.jsã«é–¢ã™ã‚‹Meetup
- ãŠé…’é£²ã¿ãªãŒã‚‰LTã™ã‚‹ä¼š
- æ¬¡å›ã¯5/23ã«é–‹å‚¬@ãƒ¡ãƒ«ãƒšã‚¤
- å‚åŠ è€…ã¯110åã»ã©

---

## SCOUTERã¨ã¯

![ä¼šç¤¾ç´¹ä»‹](src/assets/img/scouter-1.png)

---

## SCOUTERå†…ã§ã®æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- åŸºæœ¬çš„ã«å…¨ã¦Laravel + Vue.jsã®æ§‹æˆ
- ã‚¤ãƒ³ãƒ•ãƒ©ã¯AWS
- æœ€è¿‘ãƒªãƒªãƒ¼ã‚¹ã—ã¦ã„ã‚‹ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã¯ã€åŸºæœ¬çš„ã«Nuxt.jsã‚’ä½¿ç”¨

+++

## Nuxt.js

Vue.jsã®ã„ã‚ã‚“ãªTipsã‚’å‡ç¸®ã—ãŸãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯

- VueRouter
- SSR
- Vuex
- VueMeta
- webpack
- babel

+++

## Nuxt.jsã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆ

+++

![ã‚³ãƒ¼ãƒãƒ¬ãƒ¼ãƒˆ](src/assets/img/corp.png)
ã‚³ãƒ¼ãƒãƒ¬ãƒ¼ãƒˆã‚µã‚¤ãƒˆ

+++

![LP](src/assets/img/lp.png)
ã‚µãƒ¼ãƒ“ã‚¹LP

+++

![ãƒã‚¬ã‚¸ãƒ³](src/assets/img/magazine.png)
ã‚ªã‚¦ãƒ³ãƒ‰ãƒ¡ãƒ‡ã‚£ã‚¢

---

## AWSã§æ§‹ç¯‰ã™ã‚‹Nuxt.jsã®ã‚¤ãƒ³ãƒ•ãƒ©æ§‹ç¯‰

- ä»ŠNuxt.jsãŒç†±ã„ï¼
- Nuxt.jsã®è‰¯ã•ã®è¨˜äº‹ã¯å¤šã„ã‘ã©ã€ã‚¤ãƒ³ãƒ•ãƒ©ã®è©±ã¯å°‘ãªã„
- ã‚¤ãƒ³ãƒ•ãƒ©å·¥å¤«ã—ãŸã®ã§ã€ç´¹ä»‹ã—ã¾ã™
- ã¡ã‚ƒã‚“ã¨Laravelã‚‚ã„ã‚ŒãŸæ§‹æˆã‚‚èª¬æ˜ã™ã‚‹ã‚ˆ ğŸ˜…

---

## ãƒˆãƒ”ãƒƒã‚¯

- Laravel + Nuxt generate
- Wordpress + Nuxt ssr
- Nuxt SSR + Express

---

## Laravel + Nuxt generate

+++

### åŸºæœ¬ã‚¹ã‚¿ãƒ³ã‚¹

- Laravelã¨Nuxtã‚’ä¸€ç·’ã®ãƒªãƒã‚¸ãƒˆãƒªã«ç½®ã
- nuxt.config.jsã®è¨­å®šã‚’èª¿æ•´
- Travisã§NuxtGenerateã™ã‚‹
- distè¾¼ã¿ã®å…¨ä½“ã‚’Codedeployã§è¨­ç½®
- Nginxã§ãƒªãƒãƒ—ãƒ­ã™ã‚‹
- (è£œè¶³)ãƒ“ãƒ«ãƒ‰æ™‚ã«ãƒã‚§ãƒƒã‚¯ã—ã¦ãŠãã¹ããƒã‚¤ãƒ³ãƒˆ

+++

### Laravelã¨Nuxtã‚’ä¸€ç·’ã®ãƒªãƒã‚¸ãƒˆãƒªã«ç½®ã

```bash
app/
bootstrap/
config/
...
client/â†è¿½åŠ 
nuxt.config.jsâ†è¿½åŠ 
package.jsonâ†ãã®ã¾ã¾ 
```

+++

### nuxt.config.jsã®è¨­å®šã‚’èª¿æ•´

+++?code=src/laravel/nuxt.config.js&lang=js&title=nuxt.config.js

`client/` ã‚’èªè­˜ã™ã‚‹ã‚ˆã†ã«è¨­å®šã‚’è¿½åŠ 

+++

### Travisã§NuxtGenerateã™ã‚‹

+++?code=src/laravel/.travis.yml&lang=yml&title=.travis.yml

@[1-3](ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®install)
@[4-5](å…ˆã«generate)
@[6-9](ä¸è¦ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’é™¤ã„ã¦zipåŒ–)
@[11-20](S3ã«ä¸Šã’ã‚‹)

+++

### distè¾¼ã¿ã®å…¨ä½“ã‚’Codedeployã§è¨­ç½®

+++?code=src/laravel/.travis.yml&lang=yml&title=.travis.yml

@[21-31](S3ã‹ã‚‰codedeployã«æŠ•ã’ã‚‹)

+++?code=src/laravel/appspec.yml&lang=yml&title=appspec.yml

@[3-5](æ™®é€šã«è¨­ç½®ã™ã‚‹)

+++

### Nginxã§ãƒªãƒãƒ—ãƒ­ã™ã‚‹

+++?code=src/laravel/app.conf.nginx&lang=nginx&title=nginx.conf

@[4,17](ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§åˆ†å²)
@[17-22](Generateã—ã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã¯æ™®é€šã«try_filesã§å¼•ã£ã‹ã‹ã‚‹)
@[4-16](/apiã«ãªã£ã¦ã„ã‚‹ã‚‚ã®ã¯Laravelå´ã‚’å‚ç…§ã—ã«ã„ã)

+++

### (è£œè¶³)ãƒ“ãƒ«ãƒ‰æ™‚ã«ãƒã‚§ãƒƒã‚¯ã—ã¦ãŠãã¹ããƒã‚¤ãƒ³ãƒˆ

+++?code=src/laravel/.travis.yml&lang=yml&title=.travis.yml

@[1-31](`nuxt` ã‚³ãƒãƒ³ãƒ‰ã§ç”Ÿæˆã™ã‚‹ã¨ãã¨`nuxt generate`ã™ã‚‹æ™‚ã§ã€ãƒ“ãƒ«ãƒ‰ã®ãƒ•ãƒ­ãƒ¼ãŒç•°ãªã£ã¦ã„ã‚‹ã®ã§ã€)
@[4-5](CIå´ã§ã¯`nuxt generate`ãŒå¤±æ•—ã—ãªã„ã“ã¨ã‚‚ãƒã‚§ãƒƒã‚¯ã™ã‚‹å¿…è¦ãŒã‚ã‚‹)

---

## Wordpress + nuxt ssr

- WordpressAPIã‚’ä½¿ç”¨ã€‚
- å¤§ä½“ã“ã®æ‰‹ã®ã‚¢ãƒ—ãƒªã¯SEOå¯¾ç­–ãŒå¿…é ˆã«ãªã‚‹ã®ã§SSRãƒ¢ãƒ¼ãƒ‰ã«ã™ã‚‹
- ãƒ—ãƒ­ã‚»ã‚¹ç›£è¦–ã«ã¯foreverã‚’ä½¿ç”¨

+++

### ã‚µãƒãƒª

- Nuxtã®ã¿ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’è¨­ç½®ã™ã‚‹
- Travisã§nuxt build
- Codedeployã§è¨­ç½®
- foreverã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’åˆ‡ã‚‹

+++

### Nuxtã®ã¿ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’è¨­ç½®ã™ã‚‹

- Wordpress APIã‚’ä½¿ç”¨
- SpecãŒæ±ºã¾ã£ã¦ã‚‹ã®ã§ã€Wordpressã¨å…±å­˜ã™ã‚‹å¿…è¦ãŒãªã„
- æ™®é€šã«å˜ä¸€ãƒªãƒã‚¸ãƒˆãƒªã«Vue cliã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

+++?code=src/wp/nuxt.config.js&lang=js&title=nuxt.config.js

@[4-6](axios moduleã‚’ä½¿ã†)
@[7-9](baseURLã‚’wpç”¨ã«è¨­å®š)

+++

### Travisã§nuxt build

+++?code=src/wp/.travis.yml&lang=yml&title=.travis.yml

@[1-2](ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®install)
@[5-8](ä¸è¦ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’é™¤ã„ã¦zipåŒ–)
@[10-19](S3ã«ä¸Šã’ã‚‹)

+++

### Codedeployã§è¨­ç½®

+++?code=src/wp/.travis.yml&lang=yml&title=.travis.yml

@[21-31](S3ã‹ã‚‰codedeployã«æŠ•ã’ã‚‹)

+++?code=src/wp/appspec.yml&lang=yml&title=appspec.yml

@[3-5](æ™®é€šã«è¨­ç½®ã™ã‚‹)

+++

### foreverã®å¯¾è±¡ãƒ—ãƒ­ã‚»ã‚¹ã‚’åˆ‡ã£ã¦å†èµ·å‹•

- ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸Šã’ãŸã ã‘ã§ã¯å‰ã®ãƒ—ãƒ­ã‚»ã‚¹ãŒæ®‹ã£ã¦ã‚‹ã®ã§ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã«ã¯ãªã‚‰ãªã„
- foreverã¯ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç›£è¦–ã—ã€åˆ‡ã‚ŒãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§å†èµ·å‹•ã‚’è‡ªå‹•ã§è¡Œã£ã¦ãã‚Œã‚‹
- ä½•ã‹çŸ¥ã‚‰ã®æ–¹æ³•ã§ãƒ—ãƒ­ã‚»ã‚¹ã‚’åˆ‡ã‚‹ã‹ã€`forever restart`ã§å†èµ·å‹•ã‚’ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå®Œäº†ã™ã‚‹

+++?code=src/wp/appspec.yml&lang=yml&title=appspec.yml

@[22-27](èµ·å‹•è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¨­ç½®)

+++?code=src/wp/application_start.sh&lang=bash&title=application_start.sh

å†èµ·å‹•ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¨˜è¿°

---

## expressã§æ§‹ç¯‰ã™ã‚‹å ´åˆ

- ç‹¬è‡ªã®Slacké€šçŸ¥ã‚„ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç­‰ã‚µãƒ¼ãƒãƒ¼ãŒå¿…è¦ãªå ´åˆã¯Expressã‚’ä½¿ã†
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®`nuxt` `nuxt start`ã¯ä½¿ãˆãªããªã‚‹ã®ã§ç‹¬è‡ªå®Ÿè£…ãŒå¿…è¦
- ã‚„ã‚Šæ–¹ã¯Nuxt.jsã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ [ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã“ã¡ã‚‰](https://nuxtjs.org/examples/auth-routes#using-express-and-sessions)

+++

### ã‚µãƒãƒª

- ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ç”¨ã®jsãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
- developmentãƒ“ãƒ«ãƒ‰ã¨prodãƒ“ãƒ«ãƒ‰ã§åˆ†ã‘ã‚‹
- èµ·å‹•è¨­å®šã‚’å¯¾è±¡jsãƒ•ã‚¡ã‚¤ãƒ«ã«å‘ã‘ã‚‹

+++

### ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ç”¨ã®jsãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ

+++?code=src/express/server.js&lang=js&title=server.js

@[1-4](nuxtã‚„expressç­‰å¿…è¦ãªã‚‚ã®ã‚’require)
@[6-15](expressã®è¨­å®šã‚’è¨˜è¿°)
@[18-30](postãªã©ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’è¨˜è¿°)
@[33,36](prodåˆ¤å®šã‚’ã—ã¦)
@[34,37-38](developmentã§ã‚ã‚Œã°ã€buildã‚‚ãŠã“ãªã†)
@[40](startç”¨ã®è¨­å®šã‚’æ³¨å…¥)
@[41](ãƒãƒ¼ãƒˆã‚’é–‹ã‘ã‚‹)

+++

### èµ·å‹•è¨­å®šã‚’å¯¾è±¡jsãƒ•ã‚¡ã‚¤ãƒ«ã«å‘ã‘ã‚‹

+++?code=src/express/application_start.sh&lang=bash&title=application_start.sh

å†èµ·å‹•ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’server.jsã«å‘ã‘ã‚‹

---

## ã¾ã¨ã‚

- Nuxt.jsã¯ã„ã‚ã‚“ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã®é…ä¿¡æ–¹æ³•ãŒã‚ã‚‹
- å„ã€…ã®ã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆã‚’çŸ¥ã£ã¦ãŠã‘ã°ã€æ­¦å™¨ãŒå¢—ãˆã‚‹
- ã¿ã‚“ãªNuxt.jsä½¿ã£ã¦ã„ã“ã†ï¼
- Laravelã‚‚ã­
